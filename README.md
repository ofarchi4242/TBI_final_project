**OVERVIEW**

Generally, this GitHub repository contains scripts that take the original single-cell RNA sequencing (scRNA-seq) gene expression data from fluid percussion-induced traumatic brain injury (fpTBI), blast-induced traumatic brain injury (bTBI), and sham (control) mice hippocampal samples, and looks to understand the common cell types and associated gene expression perturbations that are apparent across injury models. Analysis of fpTBI and bTBI are first completed in parallel: Specifically the code first produces a Uniform Manifold Approximation and Projection for Dimension Reduction (UMAP) figure that visualizes cell clustering in an unsupervised manner; Fisher's exact test is then used to annotate clusters based on marker genes; Finally, differentially expressed genes between blast and control samples within each cell type are found. At this point overlapping DEGs between cell types and injury models are found as the analysis is combined (from fpTBI and bTBI). KEGG enrichment of these consensus markers can be used for pathway enrichment and insights in TBI pathogenesis. Overall, understanding recurring findings across cell types between two different concussive models (fp- and b- TBI) will highlight transcriptome perturbations that are more generalizable across mTBI disease (guiding mTBI pathogenesis and therapeutic target insight). These consensus gene markers can then be used to determine pathways connecting mTBI to downstream neuropathologies (because of the exhaustive list of pathways and existing biomarkers that have shown correlations between the two).

--------
**DATA**

Our dataset involves single-cell mRNAseq libraries generated from two different TBI models conducted on mouse hippocampal cells: 24hr acute fluid percussion-TBI and 48hr blast-TBI (with control conditions present in both datasets). Data are gene expression matrices containing barcode and raw unique molecular identifier (UMI) counts (n = 6 for both fpTBI and bTBI). To create the fpTBI group condition, mice were subject to a 1.5-mm diameter craniotomy and a plastic injury cap was placed over the craniotomy connected to a fluid percussion device [10]. A mild fluid percussion pulse (1.5-1.7 atm) was utilized to mimic brain injury (observed to mimic the systemic impacts after contact trauma in human TBI [15]). Then single-cell mRNAseq libraries were generated with Drop-Seq from single cell suspensions, aligned to mouse reference genome mm10 with STAR-2.5.0c, and digital gene expression matrices were created. To create bTBI group condition, mice were subject to a 5.0 MPA blast shock wave created through rupturing an aluminum sheet with high pressure compressed gas [11]. 48 hours after injury (or not in control) the hippocampal region was isolated, treated, and purified for nuclei where single-cell RNA sequencing (scRNA-seq) could be performed with 10X Genomics Chromium platform [11]. Single cell transcripts were aligned to the mouse reference genome (GRCm38 Ensembl: version 92) and provided feature-barcode matrices for each sample (paired with a list of gene names).

Publicly available gene expression dataset uploaded to Gene Expression Omnibus (GEO) project number: GSE101901 for fpTBI (https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?&acc=GSE101901) and GSE230253 for bTBI (https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE230253).

--------
**FOLDER STRUCTURE**

The repository is organized into three main folders: 

*Code*:
  
  containing the python script for each injury model (bTBI_code.py and fp_code.py) that is utilized to download the dataset, preprocess the data, create an UMAP visualization of the hippocampal cell clusters, annotate cell types, and find DEGs in each identified cell type (between control and TBI samples). combined_datasets_code.py is used to find the overlaps in the fpTBI and bTBI datasets and run KEGG pathway enrichment to gain insights on the markers

*Data*:
  
  this folder contains the unprocessed gene expression matrix and gene list utilized in the python script. There are three subfolders within this folder:
  
  (1) blast_ctrl
     
    this subfolder contains the unprocessed gene expression matrix for control hippocampal samples under "GSM7210822_genes_c-TBI.tsv" and associated gene name list under "GSM7210822_matrix_c-TBI.mtx".
 
  (2) blast_test
      
    this subfolder contains the unprocessed gene expression matrix for blast TBI hippocampal samples under "GSM7210821_genes_b-TBI.tsv" and associated gene name list under "GSM7210821_matrix_b-TBI.mtx".

  (3) tbi_matrix
      
    this subfolder contains the unprocessed gene expression matrix for fluid percussion TBI hippocampal samples under "DropSeqTBI.digital_expression.txt".

*Figures*:
 
  this folder contains the figures generated by the python script. There are two subfolders within this folder:
  
  (1) blast_figures
     
    this subfolder contains all the figures from the bTBI_code.pycode saved as png files: data processing/quality control of data, UMAP visualization of leiden clusters, cell annotations, and volcano plots of DEGs between TBI/control.
 
  (2) fp_figures
    this subfolder contains all the figures from the fp_code.py code saved as png files: data processing/quality control of data, UMAP visualization of leiden clusters, cell annotations, and volcano plots of DEGs between TBI/control.

--------
**INSTALLATION**

Run code by cloning the repository and running the hw6_20440_ps.py script after downloading the required packages (you will need to have Python installed on your system along with necessary dependencies). Navigate into the code folder: "cd Code" in terminal and then run "python hw6_20440_ps.py". Alternatively after cloning the repository you can navigate to the code folder and open the preferred text editor (Atom, Sublime, etc.) then run the script in the editor.

Required packages:

- anndata==0.10.7
  
- gseapy==1.1.2
  
- matplotlib==3.7.2
  
- numpy==1.25.2
  
- pandas==2.2.1
  
- scanpy==1.10.1
  
- scipy==1.13.0

